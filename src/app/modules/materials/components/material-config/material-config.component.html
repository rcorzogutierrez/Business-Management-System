<!-- material-config.component.html - DISEÑO COMPACTO -->

<div class="config-container">

  <!-- ========== HEADER - Usando ModuleHeaderComponent ========== -->
  <app-module-header
    icon="settings"
    title="Configuración del Módulo"
    subtitle="Administra campos personalizados y diseño del formulario"
    moduleColor="green"
    [showBackButton]="true"
    backButtonTooltip="Volver a materiales"
    [stats]="headerStats()"
    [actionButtons]="headerActions()"
    (backAction)="goBack()">
  </app-module-header>

  <!-- LOADING STATE -->
  @if (isLoading && fields.length === 0) {
    <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-12 flex flex-col items-center justify-center animate-fadeIn">
      <div class="loading-spinner"></div>
      <p class="text-sm text-slate-500 mt-3">Cargando configuración...</p>
    </div>
  }

  <!-- ============================================
       CONFIGURACIÓN DE LA TABLA - Usando componente compartido
       ============================================ -->
  @if (!isLoading && gridConfig()) {
    <div class="mb-5">
      <app-grid-config-section
        [gridConfig]="gridConfig()"
        moduleColor="green"
        entityLabel="materiales"
        [pageSizeOptions]="pageSizeOptions"
        [itemsPerPage]="itemsPerPageSignal()"
        [isLoading]="isLoading"
        [allFeaturesEnabled]="allFeaturesEnabled()"
        (configChange)="onConfigChange($event)"
        (toggleAll)="toggleAllFeatures()"
      />
    </div>
  }

  <!-- MAIN CONTENT -->
  @if (!isLoading || fields.length > 0) {
    <section class="animate-fadeIn" style="animation-delay: 0.1s">
      <app-form-designer
        [fields]="fields"
        [layout]="formLayout"
        [configService]="configService"
        [moduleName]="'materiales'"
        (layoutChange)="onLayoutChange($event)"
        (fieldAdded)="onFieldAdded()">
      </app-form-designer>
    </section>
  }

</div>
